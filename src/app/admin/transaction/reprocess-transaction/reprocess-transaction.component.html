<div class="container-fluid p-0 mt-2">
    <div class="row row-flex">
        <div class="mb-4" [ngClass]="isHistory === true ? 'col-xl-12' : 'col-xl-8'">
            <app-tran-in-reprocess 
            (reprocessSelectionEvent)="getProcessSelection($event)"
            (reasonFilterEvent)="reasonFilterEvent($event)"
            (selectedOrderNumber)="selectedOrderNumber($event)" 
            (selectedItemNum)="selectedItemNum($event)" 
            (filterCleared)="filterCleared($event)"
            
            ></app-tran-in-reprocess>
        </div>

        <div class="col-xl-4" [hidden]="isHistory">
            <app-reprocess-choice  (itemUpdatedEvent)="itemUpdatedEvent($event)" [reprocessCount]="orders"
             [isEnabled]="isEnabled" [transactionID]="transactionID" [userData]="this.userData"
             [isReprocessedChecked]="isReprocessedChecked" 
             [isCompleteChecked]="isCompleteChecked" 
             [isHistoryChecked]="isHistoryChecked" 
             ></app-reprocess-choice>

    </div>
    </div>
    <div class="row">
        <div [ngClass]="isHistory === true ? 'col-xl-12' : 'col-xl-8'">
            <mat-card class="mat-elevation-z g-card  mb-4 h-100">
                <mat-card-content>
    
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div>
                            <h2 class="card-header-title mb-0 d-flex align-items-center">
                                <div class="mat-icon-wrap me-lg-3">
                                    <span class="material-symbols-outlined">
                                        list_alt
                                    </span>
                                </div>
                                <span>Order Selection List</span>
                            </h2>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xl-6">
                            <div class="d-flex gap-12 align-items-center ">
                                <mat-form-field class="action-dropdown" appearance="outline">
                                    <mat-label>Select</mat-label>
                                    <mat-select class="employees-action" [(ngModel)]="this.columnSearch.searchColumn.colDef"
                                        (selectionChange)="resetFields($event.value)">
                                        <mat-option *ngFor="let item of displayedColumns" [value]="item.colDef">
                                            {{item.colDef}}
                                        </mat-option>
                                    </mat-select>
                                    <span class="material-symbols-outlined icon-expand-more">
                                        expand_more
                                    </span>
                                </mat-form-field>
    
                                <span class="v-br">-</span>
                                <div class="d-flex g-mini-search-box w-100">
                                    <mat-form-field class="w-100 bg-white br-8" appearance="fill"
                                        [floatLabel]="getFloatFormabelValue()"
                                        [hideRequiredMarker]="hideRequiredFormControl.value">
                                        <span class="material-symbols-outlined icon-search">
                                            Search
                                        </span>
                                        <input type="text" placeholder="Search" aria-label="Search" matInput
                                            [(ngModel)]='this.columnSearch.searchValue' [matAutocomplete]="search"
                                            (ngModelChange)="this.searchByColumn.next($event)">
                                        <mat-autocomplete #search="matAutocomplete" (optionSelected)="searchData()">
                                            <mat-option *ngFor="let option of searchAutocompleteListByCol" [value]="option">
                                                {{option}}
                                            </mat-option>
                                        </mat-autocomplete>
                                    </mat-form-field>
    
    
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-6 d-flex flex-row-reverse">
                            <mat-form-field class="action-dropdown w-30" appearance="outline">
                                <mat-label>Action</mat-label>
                                <mat-select [(value)]="selectedVariable" class="employees-action"
                                    (openedChange)="actionDialog($event)">
                                    <mat-option value="pagesNumber">Preview 50 Pages Only</mat-option>
                                    <mat-option value="set_column_sq">Set Column Sequence</mat-option>

                                    <mat-option *ngIf="deleteReplenishment" value="deleteReplenishment">Delete Replenishment</mat-option>

                                    <mat-option *ngIf="deleteSelected" value="deleteSelected">Delete Selected</mat-option>
                                    <mat-option *ngIf="deleteBySelectedReason" value="deleteBySelectedReason">Delete By Selected Reason</mat-option>
                                    <mat-option *ngIf="deleteBySelectedMessage" value="deleteBySelectedMessage">Delete By Selected Message</mat-option>
                                    <mat-option *ngIf="deleteByDateTime" value="deleteByDateTime">Delete By Date Time</mat-option>
                                    <mat-option *ngIf="deleteByItemNumber" value="deleteByItemNumber">Delete By Item Number</mat-option>
                                    <mat-option *ngIf="deleteByOrderNumber" value="deleteByOrderNumber">Delete By Order Number</mat-option>



                                </mat-select>
                                <span class="material-symbols-outlined icon-expand-more">
                                    expand_more
                                </span>
                            </mat-form-field>
                        </div>
                    </div>
    
    
    
                    <!-- <div class="card br-14 table-responsive my-3"
                    *ngIf="columnValues?.length>0 && displayedColumns && dataSource?.data?.length>0"> -->
    
                    <div class="card br-14 table-responsive my-3">
                        <!-- <ng-scrollbar style="height: 200px;"></ng-scrollbar> -->
                        <ng-scrollbar style="height:600px" track="all" class="mat-table-scrollbar">
    
                            <mat-table class="custom-table table-fix action-clickable-table" #table [dataSource]="dataSource" matSort
                                (matSortChange)="sortChange($event)">
    
                                <ng-container [matColumnDef]="col.colDef"
                                    *ngFor="let col of displayedColumns; let indexOfelement=index;">
    
                                    <th class="header" mat-header-cell *cdkHeaderCellDef mat-sort-header
                                        (sortActionDescription)="indexOfelement"
                                        style="width:auto; min-width: 250px!important;  padding: 5px 32px; border-bottom: 1px solid var(--clr-tertiary-50);">
                                        {{ col.colDef }}
    
                                    </th>
    
                                    <td *matCellDef="let element; let i = index"   style="min-width: 250px; padding: 5px 32px; border: 0; text-overflow: ellipsis; overflow: hidden; max-width: 20ch; white-space: nowrap;"  #tooltip="matTooltip" [matTooltip]="element[col.colHeader]"   matTooltipPosition="above" [matTooltipDisabled]="element[col.colHeader] && element[col.colHeader].length>25?false:true">
                                        {{element[col.colHeader] }}</td>
    
                                </ng-container>
                                
                                <tr class="mat-row w-100" *matNoDataRow  [attr.colspan]="displayedColumns && displayedColumns.length">
                                  <div class="p-3">
                                        No data available in table.
                                    </div>
                                </tr>
                                <mat-header-row *matHeaderRowDef="columnValues; sticky: true"></mat-header-row>
                                <mat-row [style.color]="rowClicked == row.id ? 'white' :''" [style.border-radius]="rowClicked == row.id ? '8px' :''"  [class.mx-2] = "rowClicked == row.id"   *matRowDef="let row; columns: columnValues;" (click)="getTransaction(row);changeTableRowColor(row.id);getTransactionInfo(false)" [style.background-color]="rowClicked == row.id ? 'var(--clr-primary-300)' :'white'"></mat-row>

                            </mat-table>
                        </ng-scrollbar>
                    </div>
                    <div class="table-pagination d-flex justify-content-start" *ngIf="columnValues.length>0 && displayedColumns && dataSource">
                        <mat-paginator [length]="this.customPagination.total" [pageSize]="20"
                            [pageSizeOptions]="[10, 20, 100]" (page)="handlePageEvent($event)"></mat-paginator>
                    </div>
                </mat-card-content>
            </mat-card>
        </div>
        <div class="col-xl-4" [hidden]="isHistory">
            <mat-card class="mat-elevation-z g-card mb-4">
                <mat-card-content>
                    <h2 class="card-header-title mb-4 d-flex align-items-center">
                        <div class="mat-icon-wrap me-lg-3 me-2">
                            <span class="mat-icon material-symbols-outlined">
                                backup_table
                            </span>
                        </div>
                        <span>Selected Transaction Info</span>
                    </h2>
                    <div>
                        <mat-form-field class="d-block w-100 mb-3" appearance="outline">
                            <mat-label>Record Created By</mat-label>
                            <input matInput name="maximumQuantity" type="text" value="{{createdBy}}" [disabled]='true'>
                        </mat-form-field>

                        <mat-form-field class="d-block w-100 mb-3" appearance="outline">
                            <mat-label>Transaction Date/Time</mat-label>
                            <input matInput name="maximumQuantity" type="text" value="{{transactionDateTime}}" [disabled]='true'>
                        </mat-form-field>

                        <mat-form-field class="d-block w-100 mb-3" appearance="outline">
                            <mat-label>Reason</mat-label>
                            <input matInput value="{{reason}}" type="text" [disabled]='true'>
                        </mat-form-field>

                        <mat-form-field class="d-block w-100 mb-3" appearance="outline">
                            <mat-label>Reason Message</mat-label>
                            <span matSuffix>
                                <mat-icon style="color:#8B8BA3; transform: rotate(45deg);">unfold_more</mat-icon>
                            </span>
                            <input matInput value="{{reasonMessage}}" type="text" [disabled]='true'>
                        </mat-form-field>
                    </div>
                    <div>
                        <button mat-flat-button color="primary" class="w-100 btn-regular" [disabled]='isEnabled' (click)="openReprocessTransactionDialogue(transactionID)">
                            Edit This Transaction
                            <mat-icon style="color:#fff; transform: rotate(45deg);">unfold_more</mat-icon>
                        </button>
                    </div>
                </mat-card-content>
            </mat-card>

            <mat-card class="mat-elevation-z g-card">
                <mat-card-content>
                    <h2 class="card-header-title mb-4 d-flex align-items-center">
                        <div class="mat-icon-wrap me-lg-3 me-2">
                            <span class="mat-icon material-symbols-outlined">
                                filter_frames
                            </span>
                        </div>
                        <span>Selected Orders</span>
                    </h2>
                    <div>
                        <mat-tab-group dynamicHeight>
                            <mat-tab label="Reprocess ({{orders.reprocess}})">
                                <div class="d-flex gap-12 my-2">
                                    <button mat-stroked-button color="primary" [disabled]="this.orders.reprocess<=0" class="button-add-all w-100" (click)="deleteOrder(0,'reprocess')">
                                        Mark All
                                    </button>

                                    <button mat-stroked-button color="warn" [disabled]="this.orders.reprocess<=0" class="button-remove-all-w-stroke w-100" (click)="deleteOrder(-1,'reprocess')">
                                        Unmark All
                                    </button>
                                </div>
                                <div class="card br-14 table-responsive px-0 mt-2">
                                    <ng-scrollbar style="height: 250px;">
                                        <mat-list class="zones-list g-card-list list-style-1" role="list">
                                            <ng-scrollbar style="height: 380px">
                                              <mat-list-item role="listitem" *ngFor="let order of orders.reprocessOrders">
                                                <span class="list-label zone-list-label">
                                                  {{order.orderNumber}}
                                                </span>
                                                <span class="list-label zone-list-label">
                                                    {{order.itemNumber}}
                                                  </span>
                                                <button mat-icon-button aria-label="Delete Function" (click)="deleteOrder(order.id,'reprocess')" matTooltip="Remove" matTooltipPosition="above">
                                                  <mat-icon class="icon-circle-cancel">close</mat-icon>
                                                </button>
                                              </mat-list-item>
                                            </ng-scrollbar>
                                          </mat-list>

                                    </ng-scrollbar>
                                </div>
                            </mat-tab>
                            <mat-tab label="Complete ({{orders.complete}})">
                                <div class="d-flex gap-12 my-2">
                                    <button mat-stroked-button color="primary" [disabled]="this.orders.complete<=0" class="button-add-all w-100" (click)="deleteOrder(0,'complete')">
                                        Mark All
                                    </button>

                                    <button mat-stroked-button color="warn" [disabled]="this.orders.complete<=0" class="button-remove-all-w-stroke w-100" (click)="deleteOrder(-1,'complete')">
                                        Unmark All
                                    </button>
                                </div>
                                <div class="card br-14 table-responsive px-0 mt-2">
                                    <ng-scrollbar style="height: 100px;">
                                        <mat-list class="zones-list g-card-list list-style-1" role="list">
                                            <ng-scrollbar style="height: 380px">
                                              <mat-list-item role="listitem" *ngFor="let order of orders.completeOrders">
                                                <span class="list-label zone-list-label">
                                                  {{order.orderNumber}}
                                                </span>
                                                <span class="list-label zone-list-label">
                                                    {{order.itemNumber}}
                                                  </span>
                                                <button mat-icon-button aria-label="Delete Function" (click)="deleteOrder(order.id,'complete')" matTooltip="Remove" matTooltipPosition="above">
                                                  <mat-icon class="icon-circle-cancel">close</mat-icon>
                                                </button>
                                              </mat-list-item>
                                            </ng-scrollbar>
                                          </mat-list>
                                    </ng-scrollbar>
                                </div>
                            </mat-tab>
                            <mat-tab label="History ({{orders.history}})">
                                <div class="d-flex gap-12 my-2">
                                    <button mat-stroked-button color="primary" [disabled]="this.orders.history<=0" class="button-add-all w-100" (click)="deleteOrder(0,'history')">
                                        Mark All
                                    </button>

                                    <button mat-stroked-button color="warn" [disabled]="this.orders.history<=0" class="button-remove-all-w-stroke w-100" (click)="deleteOrder(-1,'history')">
                                        Unmark All
                                    </button>
                                </div>
                                <div class="card br-14 table-responsive px-0 mt-2">
                                    <ng-scrollbar style="height: 100px;">
                                        <mat-list class="zones-list g-card-list list-style-1" role="list">
                                            <ng-scrollbar style="height: 380px">
                                              <mat-list-item role="listitem" *ngFor="let order of orders.historyOrders">
                                                <span class="list-label zone-list-label">
                                                  {{order.orderNumber}}
                                                </span>
                                                <span class="list-label zone-list-label">
                                                    {{order.itemNumber}}
                                                  </span>
                                                <button mat-icon-button aria-label="Delete Function" (click)="deleteOrder(order.id,'history')" matTooltip="Remove" matTooltipPosition="above">
                                                  <mat-icon class="icon-circle-cancel">close</mat-icon>
                                                </button>
                                              </mat-list-item>
                                            </ng-scrollbar>
                                          </mat-list>
                                    </ng-scrollbar>
                                </div>
                            </mat-tab>
                        </mat-tab-group>
                    </div>
                </mat-card-content>
            </mat-card>
        </div>
    </div>

</div>